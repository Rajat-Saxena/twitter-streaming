<workflow-app xmlns = "uri:oozie:workflow:0.4" name = "kafka-workflow">
   <start to = "startConsumer" />

   <action name = "startConsumer">
      <shell xmlns="uri:oozie:shell-action:0.1">
            <job-tracker>${JOB_TRACKER}</job-tracker>
            <name-node>${NAME_NODE}</name-node>
            <configuration>
                <property>
                    <name>mapred.job.queue.name</name>
                    <value>${QUEUE_NAME}</value>
                </property>
            </configuration>
            <exec>${EXE_CONSUMER}</exec>
	    <file>${CONSUMER}</file>
	  </shell>
		
      <ok to = "startProducer" />
      <error to = "kill_job" />
   </action>
   
   <action name = "startProducer">
      <shell xmlns="uri:oozie:shell-action:0.1">
            <job-tracker>${JOB_TRACKER}</job-tracker>
            <name-node>${NAME_NODE}</name-node>
            <configuration>
                <property>
                    <name>mapred.job.queue.name</name>
                    <value>${QUEUE_NAME}</value>
                </property>
            </configuration>
            <exec>${EXE_PRODUCER}</exec>
	    <file>${PRODUCER}</file>
	  </shell>
		
      <ok to = "end" />
      <error to = "kill_job" />
   </action>
      
   
   <kill name = "kill_job">
      <message>Shell action failed, error message[${wf:errorMessage(wf:lastErrorNode())}]</message>
   </kill>
	
   <end name = "end" />

</workflow-app>